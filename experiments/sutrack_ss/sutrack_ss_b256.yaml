# SUTrack-SS with Base backbone (256x256)
# Based on SSTrack: Decoupled Spatio-Temporal Consistency Learning for Self-Supervised Tracking

MODEL:
  ENCODER:
    TYPE: "fastitpnb"
    PRETRAIN_TYPE: "pretrained/itpn/fast_itpn_base_256.pth"
    STRIDE: 16
    CLASS_TOKEN: True
  
  # DSCL模块配置
  USE_DSCL: True
  DSCL:
    NUM_FRAMES: 2
    SPATIAL_HEADS: 8
    TEMPORAL_HEADS: 4
    DROP_PATH: 0.1
  
  # 自监督损失配置
  USE_SS_LOSS: True
  SS_LOSS:
    TEMPERATURE: 0.5
    CONTRASTIVE_WEIGHT: 1.0
    TEMPORAL_WEIGHT: 0.5
    USE_COSINE: True
  
  DECODER:
    TYPE: "CENTER"
    NUM_CHANNELS: 256
    CONV_TYPE: "normal"
    XAVIER_INIT: True
  
  TASK_DECODER:
    NUM_CHANNELS: 256
    FEATURE_TYPE: "average"

TRAIN:
  LR: 0.0001
  WEIGHT_DECAY: 0.0001
  EPOCH: 180
  LR_DROP_EPOCH: 144
  BATCH_SIZE: 16  # Smaller batch for base model
  NUM_WORKER: 8
  OPTIMIZER: "ADAMW"
  ENCODER_MULTIPLIER: 0.1
  FREEZE_ENCODER: False
  CE_WEIGHT: 1.0
  GIOU_WEIGHT: 2.0
  L1_WEIGHT: 5.0
  TASK_CE_WEIGHT: 1.0
  PRINT_INTERVAL: 50
  GRAD_CLIP_NORM: 0.1
  FIX_BN: False
  SCHEDULER:
    TYPE: "step"
    DECAY_RATE: 0.1
  TYPE: "normal"
  PRETRAINED_PATH: null

DATA:
  MEAN: [0.485, 0.456, 0.406]
  STD: [0.229, 0.224, 0.225]
  MAX_SAMPLE_INTERVAL: 200
  SAMPLER_MODE: "order"
  LOADER: "tracking"
  MULTI_MODAL_VISION: True
  MULTI_MODAL_LANGUAGE: True
  
  TRAIN:
    DATASETS_NAME: ["LASOT", "GOT10K_vottrain", "TRACKINGNET", "COCO"]
    DATASETS_RATIO: [1, 1, 1, 1]
    SAMPLE_PER_EPOCH: 60000
  
  SEARCH:
    NUMBER: 1
    SIZE: 256
    FACTOR: 4.0
    CENTER_JITTER: 3.5
    SCALE_JITTER: 0.5
  
  TEMPLATE:
    NUMBER: 1
    SIZE: 128
    FACTOR: 2.0
    CENTER_JITTER: 0
    SCALE_JITTER: 0

TEST:
  TEMPLATE_FACTOR: 4.0
  TEMPLATE_SIZE: 256
  SEARCH_FACTOR: 2.0
  SEARCH_SIZE: 128
  EPOCH: 500
  WINDOW: False
  NUM_TEMPLATES: 1
