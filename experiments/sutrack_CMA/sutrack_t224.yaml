# SUTrack with CMA (Cross-Modal Attention) Module Configuration
# 使用跨模态注意力机制改进多模态融合

MODEL:
  ENCODER:
    TYPE: fastitpnt
    STRIDE: 16
    PRETRAIN_TYPE: 'pretrained/itpn/fast_itpn_tiny_1600e_1k.pt'
    PATCHEMBED_INIT: halfcopy
    DROP_PATH: 0.1
    TOKEN_TYPE_INDICATE: True
    CLASS_TOKEN: True
    # CMA相关配置
    USE_CMA: True  # 启用CMA模块
    CMA_MODE: 'cma'  # 使用跨模态注意力融合
    
  TEXT_ENCODER:
    TYPE: ViT-L/14
    
  DECODER:
    TYPE: CENTER
    NUM_CHANNELS: 256
    CONV_TYPE: normal
    XAVIER_INIT: True
    
  TASK_DECODER:
    NUM_CHANNELS: 256
    FEATURE_TYPE: average

  TASK_NUM: 5
  TASK_INDEX:
    VASTTRACK: 0
    LASOT: 0
    TRACKINGNET: 0
    GOT10K: 0
    COCO: 0
    TNL2K: 1
    DEPTHTRACK: 2
    LASHER: 3
    VISEVENT: 4

TRAIN:
  LR: 0.0001
  WEIGHT_DECAY: 0.0001
  EPOCH: 180
  LR_DROP_EPOCH: 144
  BATCH_SIZE: 32
  NUM_WORKER: 10
  OPTIMIZER: ADAMW
  ENCODER_MULTIPLIER: 0.1
  FREEZE_ENCODER: False
  ENCODER_OPEN: []
  CE_WEIGHT: 1.0
  GIOU_WEIGHT: 2.0
  L1_WEIGHT: 5.0
  TASK_CE_WEIGHT: 1.0
  PRINT_INTERVAL: 50
  GRAD_CLIP_NORM: 0.1
  FIX_BN: False
  SCHEDULER:
    TYPE: step
    DECAY_RATE: 0.1
  TYPE: text_frozen
  PRETRAINED_PATH: null

DATA:
  MEAN: [0.485, 0.456, 0.406]
  STD: [0.229, 0.224, 0.225]
  MAX_SAMPLE_INTERVAL: 400
  SAMPLER_MODE: order
  LOADER: tracking
  MULTI_MODAL_VISION: True
  MULTI_MODAL_LANGUAGE: True
  USE_NLP:
    LASOT: False
    GOT10K: False
    COCO: False
    TRACKINGNET: False
    VASTTRACK: False
    REFCOCOG: False
    TNL2K: True
    OTB99: False
    DEPTHTRACK: False
    LASHER: False
    VISEVENT: False
  TRAIN:
    DATASETS_NAME: ["GOT10K_vottrain", "DepthTrack_train"]
    DATASETS_RATIO: [1, 1]
    SAMPLE_PER_EPOCH: 60000
  SEARCH:
    NUMBER: 1
    SIZE: 224
    FACTOR: 4.0
    CENTER_JITTER: 3.5
    SCALE_JITTER: 0.5
  TEMPLATE:
    NUMBER: 1
    SIZE: 112
    FACTOR: 2.0
    CENTER_JITTER: 0
    SCALE_JITTER: 0

TEST:
  TEMPLATE_FACTOR: 2.0
  TEMPLATE_SIZE: 112
  SEARCH_FACTOR: 4.0
  SEARCH_SIZE: 224
  EPOCH: 180
  WINDOW: True
  NUM_TEMPLATES: 1
  UPDATE_INTERVALS:
    DEFAULT: 999999
  UPDATE_THRESHOLD:
    DEFAULT: 1.0
  MULTI_MODAL_VISION:
    DEFAULT: True
  MULTI_MODAL_LANGUAGE:
    DEFAULT: True
  USE_NLP:
    DEFAULT: False
    TNL2K: True
